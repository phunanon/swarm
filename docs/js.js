/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/***/ (function() {


var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var scale = 6;
var speed = 1;
var screamRadius = 16;
var ants = [];
var foods = [];
var home = { x: 0, y: 0, radius: 4 };
var collected = 0;
var w = function () { return document.body.offsetWidth / scale; };
var h = function () { return document.body.offsetHeight / scale; };
window.addEventListener('DOMContentLoaded', function () {
    var _a;
    var ctx = (_a = document.querySelector('canvas')) === null || _a === void 0 ? void 0 : _a.getContext('2d');
    if (!ctx)
        return;
    ctx.canvas.addEventListener('mousemove', function (e) {
        home.x = e.offsetX / scale;
        home.y = e.offsetY / scale;
    });
    ants.push.apply(ants, new Array(512).fill(0).map(function () { return (__assign(__assign({ x: Math.random() * w(), y: Math.random() * h() }, { home: 0, food: 0, wandering: true, carrying: false }), { direction: Math.random() * Math.PI * 2 })); }));
    foods.push.apply(foods, new Array(3).fill(0).map(function () { return ({
        x: Math.random() * w(),
        y: Math.random() * h(),
        radius: 4,
        direction: Math.random() * Math.PI * 2,
    }); }));
    home.x = 32;
    home.y = h() / 2;
    Render(ctx);
});
var Render = function (ctx) {
    var width = document.body.offsetWidth;
    var height = document.body.offsetHeight;
    ctx.canvas.style.width = "".concat((ctx.canvas.width = width));
    ctx.canvas.style.height = "".concat((ctx.canvas.height = height));
    ctx.fillStyle = 'rgba(255, 255, 255, 0.25)';
    ctx.fillRect(0, 0, width, height);
    ctx.save();
    ctx.scale(scale, scale);
    ants.forEach(function (ant) {
        ctx.fillStyle = ant.carrying ? 'red' : 'black';
        ctx.fillRect(ant.x, ant.y, 1, 1);
    });
    ctx.fillStyle = 'blue';
    foods.forEach(function (food) {
        ctx.beginPath();
        ctx.arc(food.x, food.y, food.radius, 0, 2 * Math.PI);
        ctx.fill();
    });
    ctx.fillStyle = 'green';
    ctx.beginPath();
    ctx.arc(home.x, home.y, home.radius, 0, 2 * Math.PI);
    ctx.fill();
    var updates = Update();
    updates.forEach(function (_a) {
        var x1 = _a[0], y1 = _a[1], x2 = _a[2], y2 = _a[3], food = _a[4], home = _a[5];
        ctx.strokeStyle = "rgba(".concat(food && home ? 128 : 0, ", ").concat(food && !home ? 0 : 128, ", ").concat(food && !home ? 128 : 0, ", 0.05)");
        ctx.beginPath();
        ctx.moveTo(x1 + 0.5, y1 + 0.5);
        ctx.lineTo(x2 + 0.5, y2 + 0.5);
        ctx.stroke();
    });
    ctx.fillStyle = 'black';
    ctx.font = '8px monospace';
    ctx.fillText("Collected ".concat(collected), 2, 8);
    ctx.restore();
    setTimeout(function () { return Render(ctx); }, 10);
};
var near = function (a, b, radius) {
    return a.x > b.x - radius &&
        a.x < b.x + radius &&
        a.y > b.y - radius &&
        a.y < b.y + radius;
};
var Update = function () {
    var updates = [];
    foods.forEach(function (food) {
        food.x += Math.cos(food.direction) * speed * 0.2;
        food.y += Math.sin(food.direction) * speed * 0.2;
        if (food.x < food.radius) {
            food.direction = Math.PI - food.direction;
            food.x = food.radius;
        }
        if (food.x + food.radius > w()) {
            food.direction = Math.PI - food.direction;
            food.x = w() - food.radius;
        }
        if (food.y < food.radius) {
            food.direction = -food.direction;
            food.y = food.radius;
        }
        if (food.y + food.radius > h()) {
            food.direction = -food.direction;
        }
    });
    ants.forEach(function (ant) {
        ant.x += Math.cos(ant.direction) * speed;
        ant.y += Math.sin(ant.direction) * speed;
        if (ant.x < 0) {
            ant.direction = Math.PI - ant.direction;
            ant.x = 0;
            ant.wandering = true;
        }
        if (ant.x > w()) {
            ant.direction = Math.PI - ant.direction;
            ant.x = w();
            ant.wandering = true;
        }
        if (ant.y < 0) {
            ant.direction = -ant.direction;
            ant.y = 0;
            ant.wandering = true;
        }
        if (ant.y > h()) {
            ant.direction = -ant.direction;
            ant.y = h();
            ant.wandering = true;
        }
        if (near(ant, home, home.radius) && ant.carrying) {
            ant.carrying = false;
            ant.home = 0;
            ant.direction += Math.PI;
            ++collected;
        }
        if (!ant.carrying) {
            foods.forEach(function (food) {
                if (near(ant, food, food.radius)) {
                    ant.carrying = true;
                    ant.food = 0;
                    ant.direction += Math.PI;
                    food.radius -= 0.001;
                    if (food.radius < 1) {
                        food.x = Math.random() * w();
                        food.y = Math.random() * h();
                        food.radius = 4;
                        food.direction = Math.random() * Math.PI * 2;
                    }
                }
            });
        }
        if (ant.wandering) {
            ant.direction += Math.random() * 0.1 - 0.05;
        }
        ++ant.food;
        ++ant.home;
    });
    ants.forEach(function (ant) {
        ants.forEach(function (other) {
            if (ant === other)
                return;
            if (!near(ant, other, screamRadius))
                return;
            var f = ant.food + screamRadius;
            var h = ant.home + screamRadius;
            var closerFood = f < other.food;
            var closerHome = h < other.home;
            var goFood = !other.carrying && closerFood;
            var goHome = other.carrying && closerHome;
            var newDir = Math.atan2(ant.y - other.y, ant.x - other.x) +
                Math.random() * 0.5 -
                0.25;
            if (closerFood) {
                other.food = f;
            }
            else if (closerHome) {
                other.home = h;
            }
            if (closerFood || closerHome) {
                updates.push([ant.x, ant.y, other.x, other.y, closerFood, closerHome]);
            }
            if (goFood || goHome) {
                other.direction = newDir;
                other.wandering = false;
            }
        });
    });
    return updates;
};


/***/ })

/******/ 	});
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = {};
/******/ 	__webpack_modules__["./src/index.ts"]();
/******/ 	
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDOzs7Ozs7OztVRXJORjtVQUNBO1VBQ0E7VUFDQTtVQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3dhcm0vLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vc3dhcm0vd2VicGFjay9iZWZvcmUtc3RhcnR1cCIsIndlYnBhY2s6Ly9zd2FybS93ZWJwYWNrL3N0YXJ0dXAiLCJ3ZWJwYWNrOi8vc3dhcm0vd2VicGFjay9hZnRlci1zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbInR5cGUgVmVjID0geyB4OiBudW1iZXI7IHk6IG51bWJlciB9O1xyXG50eXBlIEFudCA9IFZlYyAmIHtcclxuICBkaXJlY3Rpb246IG51bWJlcjtcclxuICBob21lOiBudW1iZXI7XHJcbiAgZm9vZDogbnVtYmVyO1xyXG4gIHdhbmRlcmluZzogYm9vbGVhbjtcclxuICBjYXJyeWluZzogYm9vbGVhbjtcclxufTtcclxudHlwZSBGb29kID0gVmVjICYgeyBkaXJlY3Rpb246IG51bWJlcjsgcmFkaXVzOiBudW1iZXIgfTtcclxuXHJcbmNvbnN0IHNjYWxlID0gNjtcclxuY29uc3Qgc3BlZWQgPSAxO1xyXG5jb25zdCBzY3JlYW1SYWRpdXMgPSAxNjtcclxuY29uc3QgYW50czogQW50W10gPSBbXTtcclxuY29uc3QgZm9vZHM6IEZvb2RbXSA9IFtdO1xyXG5jb25zdCBob21lID0geyB4OiAwLCB5OiAwLCByYWRpdXM6IDQgfTtcclxubGV0IGNvbGxlY3RlZCA9IDA7XHJcbmNvbnN0IHcgPSAoKSA9PiBkb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoIC8gc2NhbGU7XHJcbmNvbnN0IGggPSAoKSA9PiBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodCAvIHNjYWxlO1xyXG5cclxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7XHJcbiAgY29uc3QgY3R4ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignY2FudmFzJyk/LmdldENvbnRleHQoJzJkJyk7XHJcbiAgaWYgKCFjdHgpIHJldHVybjtcclxuICBjdHguY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIGUgPT4ge1xyXG4gICAgaG9tZS54ID0gZS5vZmZzZXRYIC8gc2NhbGU7XHJcbiAgICBob21lLnkgPSBlLm9mZnNldFkgLyBzY2FsZTtcclxuICB9KTtcclxuXHJcbiAgYW50cy5wdXNoKFxyXG4gICAgLi4ubmV3IEFycmF5KDUxMikuZmlsbCgwKS5tYXAoKCkgPT4gKHtcclxuICAgICAgLi4ueyB4OiBNYXRoLnJhbmRvbSgpICogdygpLCB5OiBNYXRoLnJhbmRvbSgpICogaCgpIH0sXHJcbiAgICAgIC4uLnsgaG9tZTogMCwgZm9vZDogMCwgd2FuZGVyaW5nOiB0cnVlLCBjYXJyeWluZzogZmFsc2UgfSxcclxuICAgICAgZGlyZWN0aW9uOiBNYXRoLnJhbmRvbSgpICogTWF0aC5QSSAqIDIsXHJcbiAgICB9KSlcclxuICApO1xyXG4gIGZvb2RzLnB1c2goXHJcbiAgICAuLi5uZXcgQXJyYXkoMykuZmlsbCgwKS5tYXAoKCkgPT4gKHtcclxuICAgICAgeDogTWF0aC5yYW5kb20oKSAqIHcoKSxcclxuICAgICAgeTogTWF0aC5yYW5kb20oKSAqIGgoKSxcclxuICAgICAgcmFkaXVzOiA0LFxyXG4gICAgICBkaXJlY3Rpb246IE1hdGgucmFuZG9tKCkgKiBNYXRoLlBJICogMixcclxuICAgIH0pKVxyXG4gICk7XHJcblxyXG4gIGhvbWUueCA9IDMyO1xyXG4gIGhvbWUueSA9IGgoKSAvIDI7XHJcblxyXG4gIFJlbmRlcihjdHgpO1xyXG59KTtcclxuXHJcbmNvbnN0IFJlbmRlciA9IChjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCkgPT4ge1xyXG4gIGNvbnN0IHdpZHRoID0gZG9jdW1lbnQuYm9keS5vZmZzZXRXaWR0aDtcclxuICBjb25zdCBoZWlnaHQgPSBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodDtcclxuICBjdHguY2FudmFzLnN0eWxlLndpZHRoID0gYCR7KGN0eC5jYW52YXMud2lkdGggPSB3aWR0aCl9YDtcclxuICBjdHguY2FudmFzLnN0eWxlLmhlaWdodCA9IGAkeyhjdHguY2FudmFzLmhlaWdodCA9IGhlaWdodCl9YDtcclxuICBjdHguZmlsbFN0eWxlID0gJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC4yNSknO1xyXG4gIGN0eC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuXHJcbiAgY3R4LnNhdmUoKTtcclxuICBjdHguc2NhbGUoc2NhbGUsIHNjYWxlKTtcclxuXHJcbiAgYW50cy5mb3JFYWNoKGFudCA9PiB7XHJcbiAgICBjdHguZmlsbFN0eWxlID0gYW50LmNhcnJ5aW5nID8gJ3JlZCcgOiAnYmxhY2snO1xyXG4gICAgY3R4LmZpbGxSZWN0KGFudC54LCBhbnQueSwgMSwgMSk7XHJcbiAgfSk7XHJcbiAgY3R4LmZpbGxTdHlsZSA9ICdibHVlJztcclxuICBmb29kcy5mb3JFYWNoKGZvb2QgPT4ge1xyXG4gICAgY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgY3R4LmFyYyhmb29kLngsIGZvb2QueSwgZm9vZC5yYWRpdXMsIDAsIDIgKiBNYXRoLlBJKTtcclxuICAgIGN0eC5maWxsKCk7XHJcbiAgfSk7XHJcblxyXG4gIGN0eC5maWxsU3R5bGUgPSAnZ3JlZW4nO1xyXG4gIGN0eC5iZWdpblBhdGgoKTtcclxuICBjdHguYXJjKGhvbWUueCwgaG9tZS55LCBob21lLnJhZGl1cywgMCwgMiAqIE1hdGguUEkpO1xyXG4gIGN0eC5maWxsKCk7XHJcblxyXG4gIGNvbnN0IHVwZGF0ZXMgPSBVcGRhdGUoKTtcclxuICB1cGRhdGVzLmZvckVhY2goKFt4MSwgeTEsIHgyLCB5MiwgZm9vZCwgaG9tZV0pID0+IHtcclxuICAgIGN0eC5zdHJva2VTdHlsZSA9IGByZ2JhKCR7Zm9vZCAmJiBob21lID8gMTI4IDogMH0sICR7XHJcbiAgICAgIGZvb2QgJiYgIWhvbWUgPyAwIDogMTI4XHJcbiAgICB9LCAke2Zvb2QgJiYgIWhvbWUgPyAxMjggOiAwfSwgMC4wNSlgO1xyXG4gICAgY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgY3R4Lm1vdmVUbyh4MSArIDAuNSwgeTEgKyAwLjUpO1xyXG4gICAgY3R4LmxpbmVUbyh4MiArIDAuNSwgeTIgKyAwLjUpO1xyXG4gICAgY3R4LnN0cm9rZSgpO1xyXG4gIH0pO1xyXG5cclxuICBjdHguZmlsbFN0eWxlID0gJ2JsYWNrJztcclxuICBjdHguZm9udCA9ICc4cHggbW9ub3NwYWNlJztcclxuICBjdHguZmlsbFRleHQoYENvbGxlY3RlZCAke2NvbGxlY3RlZH1gLCAyLCA4KTtcclxuXHJcbiAgY3R4LnJlc3RvcmUoKTtcclxuXHJcbiAgc2V0VGltZW91dCgoKSA9PiBSZW5kZXIoY3R4KSwgMTApO1xyXG59O1xyXG5cclxuY29uc3QgbmVhciA9IChhOiBWZWMsIGI6IFZlYywgcmFkaXVzOiBudW1iZXIpID0+XHJcbiAgYS54ID4gYi54IC0gcmFkaXVzICYmXHJcbiAgYS54IDwgYi54ICsgcmFkaXVzICYmXHJcbiAgYS55ID4gYi55IC0gcmFkaXVzICYmXHJcbiAgYS55IDwgYi55ICsgcmFkaXVzO1xyXG5cclxuY29uc3QgVXBkYXRlID0gKCkgPT4ge1xyXG4gIGNvbnN0IHVwZGF0ZXM6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyLCBudW1iZXIsIGJvb2xlYW4sIGJvb2xlYW5dW10gPSBbXTtcclxuXHJcbiAgZm9vZHMuZm9yRWFjaChmb29kID0+IHtcclxuICAgIGZvb2QueCArPSBNYXRoLmNvcyhmb29kLmRpcmVjdGlvbikgKiBzcGVlZCAqIDAuMjtcclxuICAgIGZvb2QueSArPSBNYXRoLnNpbihmb29kLmRpcmVjdGlvbikgKiBzcGVlZCAqIDAuMjtcclxuXHJcbiAgICBpZiAoZm9vZC54IDwgZm9vZC5yYWRpdXMpIHtcclxuICAgICAgZm9vZC5kaXJlY3Rpb24gPSBNYXRoLlBJIC0gZm9vZC5kaXJlY3Rpb247XHJcbiAgICAgIGZvb2QueCA9IGZvb2QucmFkaXVzO1xyXG4gICAgfVxyXG4gICAgaWYgKGZvb2QueCArIGZvb2QucmFkaXVzID4gdygpKSB7XHJcbiAgICAgIGZvb2QuZGlyZWN0aW9uID0gTWF0aC5QSSAtIGZvb2QuZGlyZWN0aW9uO1xyXG4gICAgICBmb29kLnggPSB3KCkgLSBmb29kLnJhZGl1cztcclxuICAgIH1cclxuICAgIGlmIChmb29kLnkgPCBmb29kLnJhZGl1cykge1xyXG4gICAgICBmb29kLmRpcmVjdGlvbiA9IC1mb29kLmRpcmVjdGlvbjtcclxuICAgICAgZm9vZC55ID0gZm9vZC5yYWRpdXM7XHJcbiAgICB9XHJcbiAgICBpZiAoZm9vZC55ICsgZm9vZC5yYWRpdXMgPiBoKCkpIHtcclxuICAgICAgZm9vZC5kaXJlY3Rpb24gPSAtZm9vZC5kaXJlY3Rpb247XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGFudHMuZm9yRWFjaChhbnQgPT4ge1xyXG4gICAgYW50LnggKz0gTWF0aC5jb3MoYW50LmRpcmVjdGlvbikgKiBzcGVlZDtcclxuICAgIGFudC55ICs9IE1hdGguc2luKGFudC5kaXJlY3Rpb24pICogc3BlZWQ7XHJcblxyXG4gICAgaWYgKGFudC54IDwgMCkge1xyXG4gICAgICBhbnQuZGlyZWN0aW9uID0gTWF0aC5QSSAtIGFudC5kaXJlY3Rpb247XHJcbiAgICAgIGFudC54ID0gMDtcclxuICAgICAgYW50LndhbmRlcmluZyA9IHRydWU7XHJcbiAgICB9XHJcbiAgICBpZiAoYW50LnggPiB3KCkpIHtcclxuICAgICAgYW50LmRpcmVjdGlvbiA9IE1hdGguUEkgLSBhbnQuZGlyZWN0aW9uO1xyXG4gICAgICBhbnQueCA9IHcoKTtcclxuICAgICAgYW50LndhbmRlcmluZyA9IHRydWU7XHJcbiAgICB9XHJcbiAgICBpZiAoYW50LnkgPCAwKSB7XHJcbiAgICAgIGFudC5kaXJlY3Rpb24gPSAtYW50LmRpcmVjdGlvbjtcclxuICAgICAgYW50LnkgPSAwO1xyXG4gICAgICBhbnQud2FuZGVyaW5nID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGlmIChhbnQueSA+IGgoKSkge1xyXG4gICAgICBhbnQuZGlyZWN0aW9uID0gLWFudC5kaXJlY3Rpb247XHJcbiAgICAgIGFudC55ID0gaCgpO1xyXG4gICAgICBhbnQud2FuZGVyaW5nID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAobmVhcihhbnQsIGhvbWUsIGhvbWUucmFkaXVzKSAmJiBhbnQuY2FycnlpbmcpIHtcclxuICAgICAgYW50LmNhcnJ5aW5nID0gZmFsc2U7XHJcbiAgICAgIGFudC5ob21lID0gMDtcclxuICAgICAgYW50LmRpcmVjdGlvbiArPSBNYXRoLlBJO1xyXG4gICAgICArK2NvbGxlY3RlZDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWFudC5jYXJyeWluZykge1xyXG4gICAgICBmb29kcy5mb3JFYWNoKGZvb2QgPT4ge1xyXG4gICAgICAgIGlmIChuZWFyKGFudCwgZm9vZCwgZm9vZC5yYWRpdXMpKSB7XHJcbiAgICAgICAgICBhbnQuY2FycnlpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgYW50LmZvb2QgPSAwO1xyXG4gICAgICAgICAgYW50LmRpcmVjdGlvbiArPSBNYXRoLlBJO1xyXG4gICAgICAgICAgZm9vZC5yYWRpdXMgLT0gMC4wMDE7XHJcbiAgICAgICAgICBpZiAoZm9vZC5yYWRpdXMgPCAxKSB7XHJcbiAgICAgICAgICAgIGZvb2QueCA9IE1hdGgucmFuZG9tKCkgKiB3KCk7XHJcbiAgICAgICAgICAgIGZvb2QueSA9IE1hdGgucmFuZG9tKCkgKiBoKCk7XHJcbiAgICAgICAgICAgIGZvb2QucmFkaXVzID0gNDtcclxuICAgICAgICAgICAgZm9vZC5kaXJlY3Rpb24gPSBNYXRoLnJhbmRvbSgpICogTWF0aC5QSSAqIDI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoYW50LndhbmRlcmluZykge1xyXG4gICAgICBhbnQuZGlyZWN0aW9uICs9IE1hdGgucmFuZG9tKCkgKiAwLjEgLSAwLjA1O1xyXG4gICAgfVxyXG4gICAgKythbnQuZm9vZDtcclxuICAgICsrYW50LmhvbWU7XHJcbiAgfSk7XHJcblxyXG4gIGFudHMuZm9yRWFjaChhbnQgPT4ge1xyXG4gICAgYW50cy5mb3JFYWNoKG90aGVyID0+IHtcclxuICAgICAgaWYgKGFudCA9PT0gb3RoZXIpIHJldHVybjtcclxuICAgICAgaWYgKCFuZWFyKGFudCwgb3RoZXIsIHNjcmVhbVJhZGl1cykpIHJldHVybjtcclxuICAgICAgY29uc3QgZiA9IGFudC5mb29kICsgc2NyZWFtUmFkaXVzO1xyXG4gICAgICBjb25zdCBoID0gYW50LmhvbWUgKyBzY3JlYW1SYWRpdXM7XHJcbiAgICAgIGNvbnN0IGNsb3NlckZvb2QgPSBmIDwgb3RoZXIuZm9vZDtcclxuICAgICAgY29uc3QgY2xvc2VySG9tZSA9IGggPCBvdGhlci5ob21lO1xyXG4gICAgICBjb25zdCBnb0Zvb2QgPSAhb3RoZXIuY2FycnlpbmcgJiYgY2xvc2VyRm9vZDtcclxuICAgICAgY29uc3QgZ29Ib21lID0gb3RoZXIuY2FycnlpbmcgJiYgY2xvc2VySG9tZTtcclxuICAgICAgY29uc3QgbmV3RGlyID1cclxuICAgICAgICBNYXRoLmF0YW4yKGFudC55IC0gb3RoZXIueSwgYW50LnggLSBvdGhlci54KSArXHJcbiAgICAgICAgTWF0aC5yYW5kb20oKSAqIDAuNSAtXHJcbiAgICAgICAgMC4yNTtcclxuICAgICAgaWYgKGNsb3NlckZvb2QpIHtcclxuICAgICAgICBvdGhlci5mb29kID0gZjtcclxuICAgICAgfSBlbHNlIGlmIChjbG9zZXJIb21lKSB7XHJcbiAgICAgICAgb3RoZXIuaG9tZSA9IGg7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGNsb3NlckZvb2QgfHwgY2xvc2VySG9tZSkge1xyXG4gICAgICAgIHVwZGF0ZXMucHVzaChbYW50LngsIGFudC55LCBvdGhlci54LCBvdGhlci55LCBjbG9zZXJGb29kLCBjbG9zZXJIb21lXSk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGdvRm9vZCB8fCBnb0hvbWUpIHtcclxuICAgICAgICBvdGhlci5kaXJlY3Rpb24gPSBuZXdEaXI7XHJcbiAgICAgICAgb3RoZXIud2FuZGVyaW5nID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gdXBkYXRlcztcclxufTtcclxuIiwiIiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZFxudmFyIF9fd2VicGFja19leHBvcnRzX18gPSB7fTtcbl9fd2VicGFja19tb2R1bGVzX19bXCIuL3NyYy9pbmRleC50c1wiXSgpO1xuIiwiIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9