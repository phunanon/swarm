/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/***/ (function() {


var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var scale = 6;
var speed = 1;
var screamRadius = 16;
var ants = [];
var foods = [];
var newHome = { x: 0, y: 0 };
var home = { x: 0, y: 0, radius: 4 };
var collected = 0;
var w = function () { return document.body.offsetWidth / scale; };
var h = function () { return document.body.offsetHeight / scale; };
window.addEventListener('DOMContentLoaded', function () {
    var _a;
    var ctx = (_a = document.querySelector('canvas')) === null || _a === void 0 ? void 0 : _a.getContext('2d');
    if (!ctx)
        return;
    ctx.canvas.addEventListener('mousemove', function (e) {
        newHome.x = e.offsetX / scale;
        newHome.y = e.offsetY / scale;
    });
    document.body.addEventListener('keyup', function (e) {
        if (e.key === ' ') {
            home.x = newHome.x;
            home.y = newHome.y;
        }
    });
    ants.push.apply(ants, new Array(512).fill(0).map(function () { return (__assign(__assign({ x: Math.random() * w(), y: Math.random() * h() }, { home: 0, food: 0, carrying: false }), { direction: Math.random() * Math.PI * 2 })); }));
    foods.push.apply(foods, new Array(3).fill(0).map(function () { return ({
        x: Math.random() * w(),
        y: Math.random() * h(),
        radius: 4,
        direction: Math.random() * Math.PI * 2,
    }); }));
    home.x = 32;
    home.y = h() / 2;
    Render(ctx);
});
var Render = function (ctx) {
    var width = document.body.offsetWidth;
    var height = document.body.offsetHeight;
    ctx.canvas.style.width = "".concat((ctx.canvas.width = width));
    ctx.canvas.style.height = "".concat((ctx.canvas.height = height));
    ctx.fillStyle = 'rgba(255, 255, 255, 0.25)';
    ctx.fillRect(0, 0, width, height);
    ctx.save();
    ctx.scale(scale, scale);
    ants.forEach(function (ant) {
        ctx.fillStyle = ant.carrying ? 'red' : 'black';
        ctx.fillRect(ant.x, ant.y, 1, 1);
    });
    ctx.fillStyle = 'blue';
    foods.forEach(function (food) {
        ctx.beginPath();
        ctx.arc(food.x, food.y, food.radius, 0, 2 * Math.PI);
        ctx.fill();
    });
    ctx.fillStyle = 'green';
    ctx.beginPath();
    ctx.arc(home.x, home.y, home.radius, 0, 2 * Math.PI);
    ctx.fill();
    var updates = Update();
    updates.forEach(function (_a) {
        var x1 = _a[0], y1 = _a[1], x2 = _a[2], y2 = _a[3], food = _a[4], home = _a[5];
        ctx.strokeStyle = "rgba(".concat(food && home ? 128 : 0, ", ").concat(food && !home ? 0 : 128, ", ").concat(food && !home ? 128 : 0, ", 0.05)");
        ctx.beginPath();
        ctx.moveTo(x1 + 0.5, y1 + 0.5);
        ctx.lineTo(x2 + 0.5, y2 + 0.5);
        ctx.stroke();
    });
    ctx.fillStyle = 'black';
    ctx.font = '8px monospace';
    ctx.fillText("Collected ".concat(collected), 2, 8);
    ctx.restore();
    setTimeout(function () { return Render(ctx); }, 10);
};
var near = function (a, b, radius) {
    return a.x > b.x - radius &&
        a.x < b.x + radius &&
        a.y > b.y - radius &&
        a.y < b.y + radius;
};
/** Moves an object and bounces it off the canvas bounds */
var move = function (vec, radius, speedMult) {
    if (radius === void 0) { radius = 0; }
    if (speedMult === void 0) { speedMult = 1; }
    vec.x += Math.cos(vec.direction) * speed * speedMult;
    vec.y += Math.sin(vec.direction) * speed * speedMult;
    if (vec.x < radius) {
        vec.x = radius;
        vec.direction = Math.PI - vec.direction;
    }
    if (vec.x + radius > w()) {
        vec.x = w() - radius;
        vec.direction = Math.PI - vec.direction;
    }
    if (vec.y < radius) {
        vec.y = radius;
        vec.direction = -vec.direction;
    }
    if (vec.y + radius > h()) {
        vec.y = h() - radius;
        vec.direction = -vec.direction;
    }
};
var Update = function () {
    var updates = [];
    foods.forEach(function (food) { return move(food, food.radius, 0.2); });
    ants.forEach(function (ant) {
        move(ant);
        if (ant.x < 0) {
            ant.direction = Math.PI - ant.direction;
            ant.x = 0;
        }
        if (ant.x > w()) {
            ant.direction = Math.PI - ant.direction;
            ant.x = w();
        }
        if (ant.y < 0) {
            ant.direction = -ant.direction;
            ant.y = 0;
        }
        if (ant.y > h()) {
            ant.direction = -ant.direction;
            ant.y = h();
        }
        if (near(ant, home, home.radius) && ant.carrying) {
            ant.carrying = false;
            ant.home = 0;
            ant.direction += Math.PI;
            ++collected;
        }
        if (!ant.carrying) {
            foods.forEach(function (food) {
                if (near(ant, food, food.radius)) {
                    ant.carrying = true;
                    ant.food = 0;
                    ant.direction += Math.PI;
                    food.radius -= 0.001;
                    if (food.radius < 1) {
                        food.x = Math.random() * w();
                        food.y = Math.random() * h();
                        food.radius = 4;
                        food.direction = Math.random() * Math.PI * 2;
                    }
                }
            });
        }
        ++ant.food;
        ++ant.home;
    });
    ants.forEach(function (ant) {
        ants.forEach(function (other) {
            if (ant === other)
                return;
            if (!near(ant, other, screamRadius))
                return;
            var f = ant.food + screamRadius;
            var h = ant.home + screamRadius;
            var closerFood = f < other.food;
            var closerHome = h < other.home;
            var goFood = !other.carrying && closerFood;
            var goHome = other.carrying && closerHome;
            var newDir = Math.atan2(ant.y - other.y, ant.x - other.x) +
                Math.random() * 0.5 -
                0.25;
            if (closerFood) {
                other.food = f;
            }
            else if (closerHome) {
                other.home = h;
            }
            if (closerFood || closerHome) {
                updates.push([ant.x, ant.y, other.x, other.y, closerFood, closerHome]);
            }
            if (goFood || goHome) {
                other.direction = newDir;
            }
        });
    });
    return updates;
};


/***/ })

/******/ 	});
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = {};
/******/ 	__webpack_modules__["./src/index.ts"]();
/******/ 	
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QTtVQUNBO1VBQ0E7VUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL3N3YXJtLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL3N3YXJtL3dlYnBhY2svYmVmb3JlLXN0YXJ0dXAiLCJ3ZWJwYWNrOi8vc3dhcm0vd2VicGFjay9zdGFydHVwIiwid2VicGFjazovL3N3YXJtL3dlYnBhY2svYWZ0ZXItc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJ0eXBlIFZlYyA9IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfTtcclxudHlwZSBWZWMzID0gVmVjICYgeyBkaXJlY3Rpb246IG51bWJlciB9O1xyXG50eXBlIEFudCA9IFZlYzMgJiB7IGhvbWU6IG51bWJlcjsgZm9vZDogbnVtYmVyOyBjYXJyeWluZzogYm9vbGVhbiB9O1xyXG50eXBlIEZvb2QgPSBWZWMzICYgeyByYWRpdXM6IG51bWJlciB9O1xyXG50eXBlIFdhbGwgPSB7IGE6IFZlYzsgYjogVmVjIH07XHJcblxyXG5jb25zdCBzY2FsZSA9IDY7XHJcbmNvbnN0IHNwZWVkID0gMTtcclxuY29uc3Qgc2NyZWFtUmFkaXVzID0gMTY7XHJcbmNvbnN0IGFudHM6IEFudFtdID0gW107XHJcbmNvbnN0IGZvb2RzOiBGb29kW10gPSBbXTtcclxuY29uc3QgbmV3SG9tZSA9IHsgeDogMCwgeTogMCB9O1xyXG5jb25zdCBob21lID0geyB4OiAwLCB5OiAwLCByYWRpdXM6IDQgfTtcclxubGV0IGNvbGxlY3RlZCA9IDA7XHJcbmNvbnN0IHcgPSAoKSA9PiBkb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoIC8gc2NhbGU7XHJcbmNvbnN0IGggPSAoKSA9PiBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodCAvIHNjYWxlO1xyXG5cclxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7XHJcbiAgY29uc3QgY3R4ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignY2FudmFzJyk/LmdldENvbnRleHQoJzJkJyk7XHJcbiAgaWYgKCFjdHgpIHJldHVybjtcclxuICBjdHguY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIGUgPT4ge1xyXG4gICAgbmV3SG9tZS54ID0gZS5vZmZzZXRYIC8gc2NhbGU7XHJcbiAgICBuZXdIb21lLnkgPSBlLm9mZnNldFkgLyBzY2FsZTtcclxuICB9KTtcclxuICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZSA9PiB7XHJcbiAgICBpZiAoZS5rZXkgPT09ICcgJykge1xyXG4gICAgICBob21lLnggPSBuZXdIb21lLng7XHJcbiAgICAgIGhvbWUueSA9IG5ld0hvbWUueTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgYW50cy5wdXNoKFxyXG4gICAgLi4ubmV3IEFycmF5KDUxMikuZmlsbCgwKS5tYXAoKCkgPT4gKHtcclxuICAgICAgLi4ueyB4OiBNYXRoLnJhbmRvbSgpICogdygpLCB5OiBNYXRoLnJhbmRvbSgpICogaCgpIH0sXHJcbiAgICAgIC4uLnsgaG9tZTogMCwgZm9vZDogMCwgY2Fycnlpbmc6IGZhbHNlIH0sXHJcbiAgICAgIGRpcmVjdGlvbjogTWF0aC5yYW5kb20oKSAqIE1hdGguUEkgKiAyLFxyXG4gICAgfSkpXHJcbiAgKTtcclxuICBmb29kcy5wdXNoKFxyXG4gICAgLi4ubmV3IEFycmF5KDMpLmZpbGwoMCkubWFwKCgpID0+ICh7XHJcbiAgICAgIHg6IE1hdGgucmFuZG9tKCkgKiB3KCksXHJcbiAgICAgIHk6IE1hdGgucmFuZG9tKCkgKiBoKCksXHJcbiAgICAgIHJhZGl1czogNCxcclxuICAgICAgZGlyZWN0aW9uOiBNYXRoLnJhbmRvbSgpICogTWF0aC5QSSAqIDIsXHJcbiAgICB9KSlcclxuICApO1xyXG5cclxuICBob21lLnggPSAzMjtcclxuICBob21lLnkgPSBoKCkgLyAyO1xyXG5cclxuICBSZW5kZXIoY3R4KTtcclxufSk7XHJcblxyXG5jb25zdCBSZW5kZXIgPSAoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQpID0+IHtcclxuICBjb25zdCB3aWR0aCA9IGRvY3VtZW50LmJvZHkub2Zmc2V0V2lkdGg7XHJcbiAgY29uc3QgaGVpZ2h0ID0gZG9jdW1lbnQuYm9keS5vZmZzZXRIZWlnaHQ7XHJcbiAgY3R4LmNhbnZhcy5zdHlsZS53aWR0aCA9IGAkeyhjdHguY2FudmFzLndpZHRoID0gd2lkdGgpfWA7XHJcbiAgY3R4LmNhbnZhcy5zdHlsZS5oZWlnaHQgPSBgJHsoY3R4LmNhbnZhcy5oZWlnaHQgPSBoZWlnaHQpfWA7XHJcbiAgY3R4LmZpbGxTdHlsZSA9ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMjUpJztcclxuICBjdHguZmlsbFJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XHJcblxyXG4gIGN0eC5zYXZlKCk7XHJcbiAgY3R4LnNjYWxlKHNjYWxlLCBzY2FsZSk7XHJcblxyXG4gIGFudHMuZm9yRWFjaChhbnQgPT4ge1xyXG4gICAgY3R4LmZpbGxTdHlsZSA9IGFudC5jYXJyeWluZyA/ICdyZWQnIDogJ2JsYWNrJztcclxuICAgIGN0eC5maWxsUmVjdChhbnQueCwgYW50LnksIDEsIDEpO1xyXG4gIH0pO1xyXG4gIGN0eC5maWxsU3R5bGUgPSAnYmx1ZSc7XHJcbiAgZm9vZHMuZm9yRWFjaChmb29kID0+IHtcclxuICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgIGN0eC5hcmMoZm9vZC54LCBmb29kLnksIGZvb2QucmFkaXVzLCAwLCAyICogTWF0aC5QSSk7XHJcbiAgICBjdHguZmlsbCgpO1xyXG4gIH0pO1xyXG5cclxuICBjdHguZmlsbFN0eWxlID0gJ2dyZWVuJztcclxuICBjdHguYmVnaW5QYXRoKCk7XHJcbiAgY3R4LmFyYyhob21lLngsIGhvbWUueSwgaG9tZS5yYWRpdXMsIDAsIDIgKiBNYXRoLlBJKTtcclxuICBjdHguZmlsbCgpO1xyXG5cclxuICBjb25zdCB1cGRhdGVzID0gVXBkYXRlKCk7XHJcbiAgdXBkYXRlcy5mb3JFYWNoKChbeDEsIHkxLCB4MiwgeTIsIGZvb2QsIGhvbWVdKSA9PiB7XHJcbiAgICBjdHguc3Ryb2tlU3R5bGUgPSBgcmdiYSgke2Zvb2QgJiYgaG9tZSA/IDEyOCA6IDB9LCAke1xyXG4gICAgICBmb29kICYmICFob21lID8gMCA6IDEyOFxyXG4gICAgfSwgJHtmb29kICYmICFob21lID8gMTI4IDogMH0sIDAuMDUpYDtcclxuICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgIGN0eC5tb3ZlVG8oeDEgKyAwLjUsIHkxICsgMC41KTtcclxuICAgIGN0eC5saW5lVG8oeDIgKyAwLjUsIHkyICsgMC41KTtcclxuICAgIGN0eC5zdHJva2UoKTtcclxuICB9KTtcclxuXHJcbiAgY3R4LmZpbGxTdHlsZSA9ICdibGFjayc7XHJcbiAgY3R4LmZvbnQgPSAnOHB4IG1vbm9zcGFjZSc7XHJcbiAgY3R4LmZpbGxUZXh0KGBDb2xsZWN0ZWQgJHtjb2xsZWN0ZWR9YCwgMiwgOCk7XHJcblxyXG4gIGN0eC5yZXN0b3JlKCk7XHJcblxyXG4gIHNldFRpbWVvdXQoKCkgPT4gUmVuZGVyKGN0eCksIDEwKTtcclxufTtcclxuXHJcbmNvbnN0IG5lYXIgPSAoYTogVmVjLCBiOiBWZWMsIHJhZGl1czogbnVtYmVyKSA9PlxyXG4gIGEueCA+IGIueCAtIHJhZGl1cyAmJlxyXG4gIGEueCA8IGIueCArIHJhZGl1cyAmJlxyXG4gIGEueSA+IGIueSAtIHJhZGl1cyAmJlxyXG4gIGEueSA8IGIueSArIHJhZGl1cztcclxuXHJcbi8qKiBNb3ZlcyBhbiBvYmplY3QgYW5kIGJvdW5jZXMgaXQgb2ZmIHRoZSBjYW52YXMgYm91bmRzICovXHJcbmNvbnN0IG1vdmUgPSAodmVjOiBWZWMzLCByYWRpdXMgPSAwLCBzcGVlZE11bHQgPSAxKSA9PiB7XHJcbiAgdmVjLnggKz0gTWF0aC5jb3ModmVjLmRpcmVjdGlvbikgKiBzcGVlZCAqIHNwZWVkTXVsdDtcclxuICB2ZWMueSArPSBNYXRoLnNpbih2ZWMuZGlyZWN0aW9uKSAqIHNwZWVkICogc3BlZWRNdWx0O1xyXG5cclxuICBpZiAodmVjLnggPCByYWRpdXMpIHtcclxuICAgIHZlYy54ID0gcmFkaXVzO1xyXG4gICAgdmVjLmRpcmVjdGlvbiA9IE1hdGguUEkgLSB2ZWMuZGlyZWN0aW9uO1xyXG4gIH1cclxuICBpZiAodmVjLnggKyByYWRpdXMgPiB3KCkpIHtcclxuICAgIHZlYy54ID0gdygpIC0gcmFkaXVzO1xyXG4gICAgdmVjLmRpcmVjdGlvbiA9IE1hdGguUEkgLSB2ZWMuZGlyZWN0aW9uO1xyXG4gIH1cclxuICBpZiAodmVjLnkgPCByYWRpdXMpIHtcclxuICAgIHZlYy55ID0gcmFkaXVzO1xyXG4gICAgdmVjLmRpcmVjdGlvbiA9IC12ZWMuZGlyZWN0aW9uO1xyXG4gIH1cclxuICBpZiAodmVjLnkgKyByYWRpdXMgPiBoKCkpIHtcclxuICAgIHZlYy55ID0gaCgpIC0gcmFkaXVzO1xyXG4gICAgdmVjLmRpcmVjdGlvbiA9IC12ZWMuZGlyZWN0aW9uO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IFVwZGF0ZSA9ICgpID0+IHtcclxuICBjb25zdCB1cGRhdGVzOiBbbnVtYmVyLCBudW1iZXIsIG51bWJlciwgbnVtYmVyLCBib29sZWFuLCBib29sZWFuXVtdID0gW107XHJcblxyXG4gIGZvb2RzLmZvckVhY2goZm9vZCA9PiBtb3ZlKGZvb2QsIGZvb2QucmFkaXVzLCAwLjIpKTtcclxuXHJcbiAgYW50cy5mb3JFYWNoKGFudCA9PiB7XHJcbiAgICBtb3ZlKGFudCk7XHJcblxyXG4gICAgaWYgKGFudC54IDwgMCkge1xyXG4gICAgICBhbnQuZGlyZWN0aW9uID0gTWF0aC5QSSAtIGFudC5kaXJlY3Rpb247XHJcbiAgICAgIGFudC54ID0gMDtcclxuICAgIH1cclxuICAgIGlmIChhbnQueCA+IHcoKSkge1xyXG4gICAgICBhbnQuZGlyZWN0aW9uID0gTWF0aC5QSSAtIGFudC5kaXJlY3Rpb247XHJcbiAgICAgIGFudC54ID0gdygpO1xyXG4gICAgfVxyXG4gICAgaWYgKGFudC55IDwgMCkge1xyXG4gICAgICBhbnQuZGlyZWN0aW9uID0gLWFudC5kaXJlY3Rpb247XHJcbiAgICAgIGFudC55ID0gMDtcclxuICAgIH1cclxuICAgIGlmIChhbnQueSA+IGgoKSkge1xyXG4gICAgICBhbnQuZGlyZWN0aW9uID0gLWFudC5kaXJlY3Rpb247XHJcbiAgICAgIGFudC55ID0gaCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChuZWFyKGFudCwgaG9tZSwgaG9tZS5yYWRpdXMpICYmIGFudC5jYXJyeWluZykge1xyXG4gICAgICBhbnQuY2FycnlpbmcgPSBmYWxzZTtcclxuICAgICAgYW50LmhvbWUgPSAwO1xyXG4gICAgICBhbnQuZGlyZWN0aW9uICs9IE1hdGguUEk7XHJcbiAgICAgICsrY29sbGVjdGVkO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghYW50LmNhcnJ5aW5nKSB7XHJcbiAgICAgIGZvb2RzLmZvckVhY2goZm9vZCA9PiB7XHJcbiAgICAgICAgaWYgKG5lYXIoYW50LCBmb29kLCBmb29kLnJhZGl1cykpIHtcclxuICAgICAgICAgIGFudC5jYXJyeWluZyA9IHRydWU7XHJcbiAgICAgICAgICBhbnQuZm9vZCA9IDA7XHJcbiAgICAgICAgICBhbnQuZGlyZWN0aW9uICs9IE1hdGguUEk7XHJcbiAgICAgICAgICBmb29kLnJhZGl1cyAtPSAwLjAwMTtcclxuICAgICAgICAgIGlmIChmb29kLnJhZGl1cyA8IDEpIHtcclxuICAgICAgICAgICAgZm9vZC54ID0gTWF0aC5yYW5kb20oKSAqIHcoKTtcclxuICAgICAgICAgICAgZm9vZC55ID0gTWF0aC5yYW5kb20oKSAqIGgoKTtcclxuICAgICAgICAgICAgZm9vZC5yYWRpdXMgPSA0O1xyXG4gICAgICAgICAgICBmb29kLmRpcmVjdGlvbiA9IE1hdGgucmFuZG9tKCkgKiBNYXRoLlBJICogMjtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgICsrYW50LmZvb2Q7XHJcbiAgICArK2FudC5ob21lO1xyXG4gIH0pO1xyXG5cclxuICBhbnRzLmZvckVhY2goYW50ID0+IHtcclxuICAgIGFudHMuZm9yRWFjaChvdGhlciA9PiB7XHJcbiAgICAgIGlmIChhbnQgPT09IG90aGVyKSByZXR1cm47XHJcbiAgICAgIGlmICghbmVhcihhbnQsIG90aGVyLCBzY3JlYW1SYWRpdXMpKSByZXR1cm47XHJcbiAgICAgIGNvbnN0IGYgPSBhbnQuZm9vZCArIHNjcmVhbVJhZGl1cztcclxuICAgICAgY29uc3QgaCA9IGFudC5ob21lICsgc2NyZWFtUmFkaXVzO1xyXG4gICAgICBjb25zdCBjbG9zZXJGb29kID0gZiA8IG90aGVyLmZvb2Q7XHJcbiAgICAgIGNvbnN0IGNsb3NlckhvbWUgPSBoIDwgb3RoZXIuaG9tZTtcclxuICAgICAgY29uc3QgZ29Gb29kID0gIW90aGVyLmNhcnJ5aW5nICYmIGNsb3NlckZvb2Q7XHJcbiAgICAgIGNvbnN0IGdvSG9tZSA9IG90aGVyLmNhcnJ5aW5nICYmIGNsb3NlckhvbWU7XHJcbiAgICAgIGNvbnN0IG5ld0RpciA9XHJcbiAgICAgICAgTWF0aC5hdGFuMihhbnQueSAtIG90aGVyLnksIGFudC54IC0gb3RoZXIueCkgK1xyXG4gICAgICAgIE1hdGgucmFuZG9tKCkgKiAwLjUgLVxyXG4gICAgICAgIDAuMjU7XHJcbiAgICAgIGlmIChjbG9zZXJGb29kKSB7XHJcbiAgICAgICAgb3RoZXIuZm9vZCA9IGY7XHJcbiAgICAgIH0gZWxzZSBpZiAoY2xvc2VySG9tZSkge1xyXG4gICAgICAgIG90aGVyLmhvbWUgPSBoO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChjbG9zZXJGb29kIHx8IGNsb3NlckhvbWUpIHtcclxuICAgICAgICB1cGRhdGVzLnB1c2goW2FudC54LCBhbnQueSwgb3RoZXIueCwgb3RoZXIueSwgY2xvc2VyRm9vZCwgY2xvc2VySG9tZV0pO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChnb0Zvb2QgfHwgZ29Ib21lKSB7XHJcbiAgICAgICAgb3RoZXIuZGlyZWN0aW9uID0gbmV3RGlyO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIHVwZGF0ZXM7XHJcbn07XHJcbiIsIiIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0ge307XG5fX3dlYnBhY2tfbW9kdWxlc19fW1wiLi9zcmMvaW5kZXgudHNcIl0oKTtcbiIsIiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==